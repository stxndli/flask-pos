{% extends 'layouts/base.html' %}

{% block title %} Product Page {% endblock title %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#discountModal">
  Add discount code
</button>
<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th>Percentage</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for discount in discounts %}
    <tr>
      <td>{{ discount.id }}</td>
      <td>{{ discount.name }}</td>
      <td>{{ discount.percentage }}</td>
      <td id="{{discount.id}}"> <button type="button" class="btn btn-danger" data-bs-toggle="modal"
          data-bs-target="#confirmDeleteModal" onclick="handleDeleteButton(event)">
          Delete
        </button>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% include "includes/footer.html" %}
{% include "includes/discountModal.html" %}
{% with type="discount" %}
{% include "includes/confirmDeleteModal.html" %}
{% endwith %}
{% endblock content %}
{% block javascripts %}
<script>
  handleDeleteButton = (e) => {
    const modal = document.querySelector("#confirmDeleteModal")
    const id = modal.querySelector("#discountId")
    id.innerText = e.target.parentNode.id
    const form = document.querySelector("#confirmDeleteForm")
    form.id = e.target.parentNode.id
  }
</script>
{% endblock javascripts %}
